from web3 import Web3, Account
import json

rpc_eth = 'https://sepolia-rollup.arbitrum.io/rpc'
w3 = Web3(Web3.HTTPProvider(rpc_eth))
#https://t.me/mallinmakin
#https://t.me/mallinmakin
#https://t.me/mallinmakin
ERC20_ABI = json.loads('''[{"type":"error","name":"DataTooLarge","inputs":[{"type":"uint256","name":"dataLength","internalType":"uint256"},{"type":"uint256","name":"maxDataLength","internalType":"uint256"}]},{"type":"error","name":"GasLimitTooLarge","inputs":[]},{"type":"error","name":"InsufficientSubmissionCost","inputs":[{"type":"uint256","name":"expected","internalType":"uint256"},{"type":"uint256","name":"actual","internalType":"uint256"}]},{"type":"error","name":"InsufficientValue","inputs":[{"type":"uint256","name":"expected","internalType":"uint256"},{"type":"uint256","name":"actual","internalType":"uint256"}]},{"type":"error","name":"L1Forked","inputs":[]},{"type":"error","name":"NotAllowedOrigin","inputs":[{"type":"address","name":"origin","internalType":"address"}]},{"type":"error","name":"NotForked","inputs":[]},{"type":"error","name":"NotOrigin","inputs":[]},{"type":"error","name":"NotOwner","inputs":[{"type":"address","name":"sender","internalType":"address"},{"type":"address","name":"owner","internalType":"address"}]},{"type":"error","name":"NotRollupOrOwner","inputs":[{"type":"address","name":"sender","internalType":"address"},{"type":"address","name":"rollup","internalType":"address"},{"type":"address","name":"owner","internalType":"address"}]},{"type":"error","name":"RetryableData","inputs":[{"type":"address","name":"from","internalType":"address"},{"type":"address","name":"to","internalType":"address"},{"type":"uint256","name":"l2CallValue","internalType":"uint256"},{"type":"uint256","name":"deposit","internalType":"uint256"},{"type":"uint256","name":"maxSubmissionCost","internalType":"uint256"},{"type":"address","name":"excessFeeRefundAddress","internalType":"address"},{"type":"address","name":"callValueRefundAddress","internalType":"address"},{"type":"uint256","name":"gasLimit","internalType":"uint256"},{"type":"uint256","name":"maxFeePerGas","internalType":"uint256"},{"type":"bytes","name":"data","internalType":"bytes"}]},{"type":"event","name":"AllowListAddressSet","inputs":[{"type":"address","name":"user","internalType":"address","indexed":true},{"type":"bool","name":"val","internalType":"bool","indexed":false}],"anonymous":false},{"type":"event","name":"AllowListEnabledUpdated","inputs":[{"type":"bool","name":"isEnabled","internalType":"bool","indexed":false}],"anonymous":false},{"type":"event","name":"InboxMessageDelivered","inputs":[{"type":"uint256","name":"messageNum","internalType":"uint256","indexed":true},{"type":"bytes","name":"data","internalType":"bytes","indexed":false}],"anonymous":false},{"type":"event","name":"InboxMessageDeliveredFromOrigin","inputs":[{"type":"uint256","name":"messageNum","internalType":"uint256","indexed":true}],"anonymous":false},{"type":"event","name":"Paused","inputs":[{"type":"address","name":"account","internalType":"address","indexed":false}],"anonymous":false},{"type":"event","name":"Unpaused","inputs":[{"type":"address","name":"account","internalType":"address","indexed":false}],"anonymous":false},{"type":"function","stateMutability":"view","outputs":[{"type":"bool","name":"","internalType":"bool"}],"name":"allowListEnabled","inputs":[]},{"type":"function","stateMutability":"view","outputs":[{"type":"address","name":"","internalType":"contract IBridge"}],"name":"bridge","inputs":[]},{"type":"function","stateMutability":"view","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"calculateRetryableSubmissionFee","inputs":[{"type":"uint256","name":"dataLength","internalType":"uint256"},{"type":"uint256","name":"baseFee","internalType":"uint256"}]},{"type":"function","stateMutability":"payable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"createRetryableTicket","inputs":[{"type":"address","name":"to","internalType":"address"},{"type":"uint256","name":"l2CallValue","internalType":"uint256"},{"type":"uint256","name":"maxSubmissionCost","internalType":"uint256"},{"type":"address","name":"excessFeeRefundAddress","internalType":"address"},{"type":"address","name":"callValueRefundAddress","internalType":"address"},{"type":"uint256","name":"gasLimit","internalType":"uint256"},{"type":"uint256","name":"maxFeePerGas","internalType":"uint256"},{"type":"bytes","name":"data","internalType":"bytes"}]},{"type":"function","stateMutability":"payable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"createRetryableTicketNoRefundAliasRewrite","inputs":[{"type":"address","name":"to","internalType":"address"},{"type":"uint256","name":"l2CallValue","internalType":"uint256"},{"type":"uint256","name":"maxSubmissionCost","internalType":"uint256"},{"type":"address","name":"excessFeeRefundAddress","internalType":"address"},{"type":"address","name":"callValueRefundAddress","internalType":"address"},{"type":"uint256","name":"gasLimit","internalType":"uint256"},{"type":"uint256","name":"maxFeePerGas","internalType":"uint256"},{"type":"bytes","name":"data","internalType":"bytes"}]},{"type":"function","stateMutability":"payable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"depositEth","inputs":[{"type":"uint256","name":"","internalType":"uint256"}]},{"type":"function","stateMutability":"payable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"depositEth","inputs":[]},{"type":"function","stateMutability":"nonpayable","outputs":[],"name":"initialize","inputs":[{"type":"address","name":"_bridge","internalType":"contract IBridge"},{"type":"address","name":"_sequencerInbox","internalType":"contract ISequencerInbox"}]},{"type":"function","stateMutability":"view","outputs":[{"type":"bool","name":"","internalType":"bool"}],"name":"isAllowed","inputs":[{"type":"address","name":"","internalType":"address"}]},{"type":"function","stateMutability":"nonpayable","outputs":[],"name":"pause","inputs":[]},{"type":"function","stateMutability":"view","outputs":[{"type":"bool","name":"","internalType":"bool"}],"name":"paused","inputs":[]},{"type":"function","stateMutability":"nonpayable","outputs":[],"name":"postUpgradeInit","inputs":[{"type":"address","name":"","internalType":"contract IBridge"}]},{"type":"function","stateMutability":"nonpayable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"sendContractTransaction","inputs":[{"type":"uint256","name":"gasLimit","internalType":"uint256"},{"type":"uint256","name":"maxFeePerGas","internalType":"uint256"},{"type":"address","name":"to","internalType":"address"},{"type":"uint256","name":"value","internalType":"uint256"},{"type":"bytes","name":"data","internalType":"bytes"}]},{"type":"function","stateMutability":"payable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"sendL1FundedContractTransaction","inputs":[{"type":"uint256","name":"gasLimit","internalType":"uint256"},{"type":"uint256","name":"maxFeePerGas","internalType":"uint256"},{"type":"address","name":"to","internalType":"address"},{"type":"bytes","name":"data","internalType":"bytes"}]},{"type":"function","stateMutability":"payable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"sendL1FundedUnsignedTransaction","inputs":[{"type":"uint256","name":"gasLimit","internalType":"uint256"},{"type":"uint256","name":"maxFeePerGas","internalType":"uint256"},{"type":"uint256","name":"nonce","internalType":"uint256"},{"type":"address","name":"to","internalType":"address"},{"type":"bytes","name":"data","internalType":"bytes"}]},{"type":"function","stateMutability":"payable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"sendL1FundedUnsignedTransactionToFork","inputs":[{"type":"uint256","name":"gasLimit","internalType":"uint256"},{"type":"uint256","name":"maxFeePerGas","internalType":"uint256"},{"type":"uint256","name":"nonce","internalType":"uint256"},{"type":"address","name":"to","internalType":"address"},{"type":"bytes","name":"data","internalType":"bytes"}]},{"type":"function","stateMutability":"nonpayable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"sendL2Message","inputs":[{"type":"bytes","name":"messageData","internalType":"bytes"}]},{"type":"function","stateMutability":"nonpayable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"sendL2MessageFromOrigin","inputs":[{"type":"bytes","name":"messageData","internalType":"bytes"}]},{"type":"function","stateMutability":"nonpayable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"sendUnsignedTransaction","inputs":[{"type":"uint256","name":"gasLimit","internalType":"uint256"},{"type":"uint256","name":"maxFeePerGas","internalType":"uint256"},{"type":"uint256","name":"nonce","internalType":"uint256"},{"type":"address","name":"to","internalType":"address"},{"type":"uint256","name":"value","internalType":"uint256"},{"type":"bytes","name":"data","internalType":"bytes"}]},{"type":"function","stateMutability":"nonpayable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"sendUnsignedTransactionToFork","inputs":[{"type":"uint256","name":"gasLimit","internalType":"uint256"},{"type":"uint256","name":"maxFeePerGas","internalType":"uint256"},{"type":"uint256","name":"nonce","internalType":"uint256"},{"type":"address","name":"to","internalType":"address"},{"type":"uint256","name":"value","internalType":"uint256"},{"type":"bytes","name":"data","internalType":"bytes"}]},{"type":"function","stateMutability":"nonpayable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"sendWithdrawEthToFork","inputs":[{"type":"uint256","name":"gasLimit","internalType":"uint256"},{"type":"uint256","name":"maxFeePerGas","internalType":"uint256"},{"type":"uint256","name":"nonce","internalType":"uint256"},{"type":"uint256","name":"value","internalType":"uint256"},{"type":"address","name":"withdrawTo","internalType":"address"}]},{"type":"function","stateMutability":"view","outputs":[{"type":"address","name":"","internalType":"contract ISequencerInbox"}],"name":"sequencerInbox","inputs":[]},{"type":"function","stateMutability":"nonpayable","outputs":[],"name":"setAllowList","inputs":[{"type":"address[]","name":"user","internalType":"address[]"},{"type":"bool[]","name":"val","internalType":"bool[]"}]},{"type":"function","stateMutability":"nonpayable","outputs":[],"name":"setAllowListEnabled","inputs":[{"type":"bool","name":"_allowListEnabled","internalType":"bool"}]},{"type":"function","stateMutability":"nonpayable","outputs":[],"name":"unpause","inputs":[]},{"type":"function","stateMutability":"payable","outputs":[{"type":"uint256","name":"","internalType":"uint256"}],"name":"unsafeCreateRetryableTicket","inputs":[{"type":"address","name":"to","internalType":"address"},{"type":"uint256","name":"l2CallValue","internalType":"uint256"},{"type":"uint256","name":"maxSubmissionCost","internalType":"uint256"},{"type":"address","name":"excessFeeRefundAddress","internalType":"address"},{"type":"address","name":"callValueRefundAddress","internalType":"address"},{"type":"uint256","name":"gasLimit","internalType":"uint256"},{"type":"uint256","name":"maxFeePerGas","internalType":"uint256"},{"type":"bytes","name":"data","internalType":"bytes"}]}]''')

eth_contract_address = Web3.to_checksum_address('0xe1e3b1cbacc870cb6e5f4bdf246feb6eb5cd351b')
eth_contract = w3.eth.contract(eth_contract_address, abi=ERC20_ABI)

def bridge(account):
    address = account.address
    nonce = w3.eth.get_transaction_count(address)
    
    transaction = eth_contract.functions.depositEth().build_transaction({
        'gas': 283047,
        'from': address,
        'nonce': nonce,
        'value': 3000000000000000


    })
    transaction.update({'maxFeePerGas': w3.eth.fee_history(w3.eth.get_block_number(), 'latest')['baseFeePerGas'][-1] + w3.eth.max_priority_fee})
    transaction.update({'maxPriorityFeePerGas': w3.eth.max_priority_fee})
    signed_txn = w3.eth.account.sign_transaction(transaction, private_key=account.key)
    txn = w3.eth.send_raw_transaction(signed_txn.rawTransaction)
    return txn

txt = 'privates.txt'
with open(txt, 'r', encoding = 'utf-8') as keys_file:
    accounts = [Account.from_key(line.replace("\n", "")) for line in keys_file.readlines()]
    for account in accounts:
        txn = bridge(account)
        print(f'https://sepolia-explorer.arbitrum.io/tx/{txn.hex()}')
